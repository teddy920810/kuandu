<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>产品列表-床品系列</title>
		<meta name="viewport" content="width=320,maximum-scale=1.3,user-scalable=no">
		<link rel="stylesheet" href="css/normal.css" />
		<link rel="stylesheet" type="text/css" href="css/small.css" media="screen and (max-width:319px)"/>
		<link rel="stylesheet" type="text/css" href="css/small.css" media="screen and (min-width:320px) and (max-width:767px)"/>
		<link rel="stylesheet" type="text/css" href="css/medium.css"   media="screen and (min-width:768px) and (max-width:1023px)"/>
		<link rel="stylesheet" type="text/css" href="css/big.css"  media="screen and (min-width:1024px)"/>
		<link rel="stylesheet" type="text/css" href="css/nav.css"/>
		<link rel="stylesheet" href="css/bootstrap.css"/>
		<script src="js/modernizr.custom.js"></script>
		<script src="js/classie.js"></script>
		<!-- VUE -->
		<script src="https://cdn.jsdelivr.net/npm/vue"></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	</head>
	<body style="margin: 0;">
		<!----------- 右上角导航开始 ------------>
		<div class="nav-show">
		    <a href="#" class="open-bot no-href" id="dh" title="展开导航">展开导航</a>
		</div>
		<div class="p1-b">
		    <div class="arr">
		        <div class="arr2">
		            <a href="#page2">
		                <img src="images/jt.png">
		            </a>
		        </div>
		    </div>
		</div>
		<!-- 导航 -->
		<div class="overlay overlay-scale">
		    <button type="button" class="overlay-close">关闭</button>
		    <nav>
				<ul>
					<li><a href="index.html" target="_self">网站首页<br><span>HOME</span><div class="bj"></div></a></li>
					<li><a href="our-products.html" target="_self">产品列表<br><span>OUR PRODUCTS</span><div class="bj"></div></a></li>
					<li><a href="culture.html" target="_self">品牌文化<br><span>BRAND CULTURE</span><div class="bj"></div></a></li>
					<li><a href="institution.html" target="_self">企事业单位定制<br><span>ENTERPRISE CUSTOM</span><div class="bj"></div></a></li>
					<li><a href="contact.html" target="_self">联系我们<br><span>CONTACT US</span><div class="bj"></div></a></li>
				</ul>
		    </nav>
		    <div class="hs-service-bg"></div>
		</div>
		<!----------- 右上角导航结束 ------------>
		<!-------------- logo开始 ------------------>
		<div class="width-100 text-center product-logo">
			<img src="images/product-logo.png" />
		</div>
		<div class="clearfix"></div>

		<!-------------- logo结束 ------------------>
		<div class="product-nav width-100">
			<div class="wrapper-878 pro-wrapper-nav">
				<ul>
					<li><a href="index.html">首页</a></li>
					<li class="nav-li-hover"><a href="our-products.html">产品列表</a></li>
					<li><a href="culture.html">品牌文化</a></li>
					<li><a href="institution.html">企事业单位</a></li>
					<li><a href="contact.html">联系我们</a></li>
				</ul>
				<div class="clearfix"></div>
			</div>
		</div>
		<div class="clearfix"></div>
		<div id="app">
			<div class="container mar-top-30 pro-tab-con">
				<div class="row padd-lr-40">
					<div v-for="item in seriesList" key="item.id" :class="item.id===currentSeries.id?'col-sm-6 col-md-6 col-lg-6 text-center border-brown pro-tab-nr':'col-sm-3 col-md-3 col-lg-3 text-center pro-tab-nr2'">
						<div v-if="item.id===currentSeries.id" class="value">
							<img :src="item.iconUrl" class="img-fluid" alt="Responsive image">
						</div>
						<div v-if="item.id===currentSeries.id" class="pro-tab-ul value">
							<p class="font-18 color-brown">{{item.name}}</p>
							<ul>
								<li v-for="kids  in item.children"><a href="">{{kids.name}}</a></li>
							</ul>
							<div class="clearfix"></div>
						</div>
						<a v-else :href="'our-products.html?seriesId='+item.id" class="col-sm-3 col-md-3 col-lg-3 text-center">
							<img :src="item.iconUrl" class="img-fluid" alt="Responsive image">
							<p>{{item.name}}</p>
						</a>
					</div>
				</div>
				<div class="clearfix"></div>
			</div>
			<div class="container">
				<!---------- 列表开始 ---------->
				<div class="row">
					<a v-for="item in productList" :href="'products-detail.html?id='+item.id" class="col-sm-6 col-md-4 col-lg-4 pro-w-con">
						<div class="pro-w-wrapper">
						<img :src="item.picUrl" />
						<p class="pro-w-bg">{{item.name}}</p>
					  </div>
					</a>
					<!--<a class="col-sm-6 col-md-4 col-lg-4 pro-w-con">
						<div class="pro-w-wrapper">
						  <img src="images/pro-img.png" />
						  <p class="pro-w-bg">Pimperne 紫繁篓纯棉四件套</p>
						</div>
					</a>-->
				</div>
			</div>
			<!---------- 列表结束 ---------->
			<!---------- 分页开始 ---------->
			<div class="container">
				<div class="pro-page row">
					<div class="text-center col-sm-6 col-md-6 col-lg-6 btn-pre" @click="prePage">上一页</div>
					<div class="text-center col-sm-6 col-md-6 col-lg-6 btn-next" @click="nextPage">下一页</div>
				</div>
			</div>
			<!---------- 分页结束 ---------->
			<!---------- 底部 -------------->
			<div class="pro-bottom width-100">
				<div class="container">
					<div class="row">
						<div class="col-sm-3 col-md-3 col-lg-3 bot-list">
							<div class="pro-bot-icon value">
								<img src="images/bot-img1.png" />
							</div>
							<div class="bot-font value">
								<p class="font-14">联系电话</p>
								<div class="font-24">{{ footer.tel }}</div>
							</div>
						</div>
						<div class="col-sm-3 col-md-3 col-lg-3 bot-list">
							<div class="pro-bot-icon value">
								<img src="images/bot-img2.png" />
							</div>
							<div class="bot-font value">
								<p class="font-14">电子邮箱</p>
								<div class="font-24">{{ footer.email }}</div>
							</div>
						</div>
						<div class="col-sm-3 col-md-3 col-lg-3 bot-list">
							<div class="pro-bot-icon value">
								<img src="images/bot-img3.png" />
							</div>
							<div class="bot-font value">
								<p class="font-14">地址</p>
								<div class="font-16">{{ footer.address }}</div>
							</div>
						</div>
						<div class="col-sm-3 col-md-3 col-lg-3 bot-code">
							<img src="images/bot-code.png" :src="footer.qrCode" />
						</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript">
			(function() {
				var triggerBttn = document.getElementById('dh'),
					overlay = document.querySelector('div.overlay'),
					closeBttn = overlay.querySelector('button.overlay-close');
				transEndEventNames = {
						'WebkitTransition': 'webkitTransitionEnd',
						'MozTransition': 'transitionend',
						'OTransition': 'oTransitionEnd',
						'msTransition': 'MSTransitionEnd',
						'transition': 'transitionend'
					},
					transEndEventName = transEndEventNames[Modernizr.prefixed('transition')],
					support = {
						transitions: Modernizr.csstransitions
					};

				function toggleOverlay() {
					if (classie.has(overlay, 'open')) {
						classie.remove(overlay, 'open');
						classie.add(overlay, 'close');
						var onEndTransitionFn = function(ev) {
							if (support.transitions) {
								if (ev.propertyName !== 'visibility') return;
								this.removeEventListener(transEndEventName, onEndTransitionFn);
							}
							classie.remove(overlay, 'close');
						};
						if (support.transitions) {
							overlay.addEventListener(transEndEventName, onEndTransitionFn);
						} else {
							onEndTransitionFn();
						}
					} else if (!classie.has(overlay, 'close')) {
						classie.add(overlay, 'open');
					}
				}

				triggerBttn.addEventListener('click', toggleOverlay);
				closeBttn.addEventListener('click', toggleOverlay);
			})();

		</script>

		<script>
			var app = new Vue({
				el: '#app',
				data: {
					page:1,
					limit:9,
					pages:1,
					total:0,
					productList: [],
					seriesList:[],
					currentSeries: {},
					footer: {
						tel: '',
						email: '',
						address: '',
						qrCode: ''
					}
				},
				created () {
					this.fetchFooter()
					this.fetchList(this.getQueryString("seriesId"))
				},
				methods: {
					fetchList (seriesId) {
						let url = ""
						if(seriesId == null){
							url = "http://132.232.65.201:8080/kudo/product/?seriesId=0"
						}else{
							url = "http://132.232.65.201:8080/kudo/product/?seriesId="+seriesId
						}
						url = url + "&page=" + this.page
						axios.get(url).then((response) => {
							this.productList = response.data.data.productList
							this.seriesList = response.data.data.seriesList
							this.currentSeries = response.data.data.currentSeries
							this.page = response.data.data.page
							this.limit = response.data.data.limit
							this.pages = response.data.data.pages
							this.total = response.data.data.total
							console.log(this.seriesList,this.productList)
						}).catch(function (error) {
							console.log(error);
						});
					},
					fetchFooter() {
						let url = "http://132.232.65.201:8080/kudo/footer/"
						axios.get(url).then((response) => {
							this.footer = response.data.data
							console.log(this.footer)
						}).catch(function (error) {
							console.log(error);
						});
					},
					prePage() {
						this.page = this.page - 1
						this.fetchList(this.currentSeries.id)
					},
					nextPage() {
						this.page = this.page + 1
						this.fetchList(this.currentSeries.id)
					},
					getQueryString(name) {
						let reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
						let r = window.location.search.substr(1).match(reg);//search,查询？后面的参数，并匹配正则
						if(r!=null)return  unescape(r[2]); return null;
					}
				}
			})
		</script>
	</body>
</html>
